{% extends "blog/base.html" %}
{% load static %}

{% block title %}Subscribe - FatPyBlog{% endblock %}

{% with page_subtitle="Subscribe to Updates" %}
{% block extra_head %}
<style>
    /* Page-specific styles */
    .container #main {
        max-width: 700px;
        margin: 1.5rem auto;
    }
    #main {
        text-align: center;
    }
    
    .field-error-text {
        color: #dc3545;
        font-size: 0.85rem;
        margin-top: 0.25rem;
        text-align: left;
        display: block;
    }
    
    .alert-error {
        background-color: #f8d7da;
        border-color: #f5c6cb;
        color: #721c24;
        padding: 0.75rem 1.25rem;
        border-radius: 0.25rem;
        margin-bottom: 1.5rem;
        text-align: left;
    }
</style>
{% endblock %}

{% block header_content %}
{% include "blog/partials/_header_actions.html" %}
{% endblock %}

{% block content %}
{% if request.GET.subscribed == "true" %}
    <div class="alert alert-success" id="success-message">
        Thank you for subscribing! You will now receive updates about our latest posts.
    </div>
{% endif %}

<p class="intro-text">Join our newsletter to stay updated with the latest posts and developments.</p>

<h3>Subscriber Benefits:</h3>
<ul class="benefits-list">
    <li>Get notified about new blog posts immediately</li>
    <li>Stay updated with the latest developments and news</li>
    <li>Unsubscribe anytime with a single click</li>
</ul>

<div class="subscription-form">
    <h3 class="form-title">Subscribe to Our Newsletter</h3>
    
    {% if form.errors %}
    <div class="alert alert-error">
        <h5 class="alert-heading">Please correct the following errors:</h5>
        <ul class="error-list mb-0">
            {% for field in form %}
                {% for error in field.errors %}
                    <li><strong>{{ field.label }}:</strong> {{ error }}</li>
                {% endfor %}
            {% endfor %}
            {% for error in form.non_field_errors %}
                <li>{{ error }}</li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}
    
    <form method="post" id="subscription-form">
        {% csrf_token %}
        <div class="form-field">
            {{ form.email }}
            {% if form.email.errors %}
                <div class="field-error-text">{{ form.email.errors.0 }}</div>
            {% endif %}
        </div>
        <button type="submit" id="subscribe-button">Subscribe</button>
        <p class="form-footer">We respect your privacy. Your email will never be shared.</p>
    </form>
</div>
{% endblock %}
{% endwith %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const emailInput = document.querySelector('input[type="email"]');
        emailInput.addEventListener('input', function() {
            const email = this.value;
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            
            if (emailPattern.test(email)) {
                this.style.borderColor = '#4CAF50';
            } else {
                this.style.borderColor = email ? '#f44336' : '#ccc';
            }
        });
        
        // Scroll to success message if present
        const successMessage = document.getElementById('success-message');
        if (successMessage) {
            window.scrollTo(0, 0);
        }
    });
</script>
{% endblock %}
